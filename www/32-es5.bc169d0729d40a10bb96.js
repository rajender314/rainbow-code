!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i(e);if(t){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{GwlF:function(t,r,a){"use strict";a.r(r),a.d(r,"UserManagementPageModule",(function(){return ye}));var i,s,m=a("ofXK"),u=a("3Pt+"),d=a("TEn/"),p=a("tyNb"),f=a("mrSG"),v=a("VfN6"),h=a("6UR0"),g=a("S3p7"),S=a("jrR7"),b=a("BKks"),y=a("fXoL"),E=a("hrw+"),w=a("jMvV"),x=["locations"],k=["roles"],I=["groups"],C=["manager"],j=((i=function(){function e(t,n,r,o,a){l(this,e),this.baseAPI=t,this.loadingCntrl=n,this.formBuilder=r,this.popoverService=o,this.inputData=a,this.apiDirectory=b.c,this.preferredCountry=["in"]}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.formGroup=this.intialiseForm(),this.popoverService.userSettings.settings.pipe(Object(v.b)(this)).subscribe((function(t){console.log("in"),e.preferredCountry=["in".toLowerCase()]}))}},{key:"ngAfterViewInit",value:function(){this.disableLocationSelection()}},{key:"intialiseForm",value:function(){return this.formBuilder.group({user_id:["",u.u.required],name:["",u.u.required],role_id:["",u.u.required],place_id:["",u.u.required],manager_id:[""],mobile_number:["",[u.u.required]],date_joined:[""],password:["",u.u.required],groups:this.formBuilder.array([])})}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"closed";this.inputData.data.onClose(e,t)}},{key:"getData",value:function(){var e=Object.assign({},this.formGroup.value);return e.date_joined==Object(S.k)(e.date_joined.format)&&e.date_joined.format(S.a),e.groups=e.groups.map((function(e){return e.id})),e}},{key:"submitForm",value:function(){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.formGroup.valid){e.next=6;break}return t=this.getData(),e.next=4,this.loadingCntrl.create({message:"Submitting..."});case 4:(n=e.sent).present(),this.baseAPI.executePost({url:b.c.user,body:t}).subscribe((function(e){n.dismiss(),r.close(e,"selected"),r.popoverService.showToast("The user has been created successfully.",1500,["success-toast"])}),(function(e){console.log(e),n.dismiss(),r.popoverService.showToast("The user could not be created. Please try later.",1500,["error-toast"])}));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"handleRoleSelection",value:function(e){this.roleControl.markAllAsTouched(),this.roleControl.setValue(e?e.role_id:""),this.locationMS.reset(),this.locationControl.setValue(""),(null==e?void 0:e.role_id)&&(null==e?void 0:e.role_id)>0?(this.locationMS.disabled=!1,this.reloadLocations(e)):this.disableLocationSelection()}},{key:"disableLocationSelection",value:function(){var e=this;setTimeout((function(){e.locationMS.disabled=!0,e.locationMS.disabledMessage="Please select a role to enable location selection"}))}},{key:"reloadLocations",value:function(e){}},{key:"handleLocationSelection",value:function(e){this.locationControl.markAllAsTouched(),this.locationControl.setValue(e?e.id:"")}},{key:"handleGroupSelection",value:function(e){var t=this,n=this.groupControl;n.clear(),e.forEach((function(e){n.push(t.formBuilder.group(e))})),n.markAllAsTouched()}},{key:"handleManagerSelection",value:function(e){this.managerControl.markAllAsTouched(),this.managerControl.setValue(e?e.id:"")}},{key:"mobileControl",get:function(){return this.formGroup.get("mobile_number")}},{key:"roleControl",get:function(){return this.formGroup.get("role_id")}},{key:"locationControl",get:function(){return this.formGroup.get("place_id")}},{key:"groupControl",get:function(){return this.formGroup.get("groups")}},{key:"managerControl",get:function(){return this.formGroup.get("manager_id")}}]),e}()).\u0275fac=function(e){return new(e||i)(y["\u0275\u0275directiveInject"](E.a),y["\u0275\u0275directiveInject"](d.I),y["\u0275\u0275directiveInject"](u.d),y["\u0275\u0275directiveInject"](w.a),y["\u0275\u0275directiveInject"](g.a))},i.\u0275cmp=y["\u0275\u0275defineComponent"]({type:i,selectors:[["adj-add-user"]],viewQuery:function(e,t){var n;1&e&&(y["\u0275\u0275viewQuery"](x,!0,h.a),y["\u0275\u0275viewQuery"](k,!0,h.a),y["\u0275\u0275viewQuery"](I,!0,h.a),y["\u0275\u0275viewQuery"](C,!0,h.a)),2&e&&(y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.locationMS=n.first),y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.roleMS=n.first),y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.groupMS=n.first),y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.managerMS=n.first))},decls:0,vars:0,template:function(e,t){},styles:["[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}  button.country-selector{margin-left:-12px}"]}),i=Object(f.b)([Object(v.a)()],i)),_=a("7vyj"),O=a("2Q4r"),M=a("he5r"),A=function(e){n(r,e);var t=o(r);function r(){return l(this,r),t.apply(this,arguments)}return c(r,[{key:"copy",value:function(){return Object.assign(new r,this)}},{key:"toQureryMap",value:function(){var e=new Map;return e.set("groups",this.nullOrPrimaryKeys(this.groups,(function(e){return e.id}))),e.set("role",this.role?this.role.role_id:null),e.set("manager",this.manager?this.manager.id:null),e.set("place",this.place?this.place.id:null),e}}]),r}(a("pmdr").a),P=a("kmnG"),D=a("qFsG"),R=((s=function(){function e(t,n,r,o,a){l(this,e),this.baseAPI=t,this.loadingCntrl=n,this.formBuilder=r,this.popoverService=o,this.inputData=a}return c(e,[{key:"ngOnInit",value:function(){this.user=this.inputData.data.parameters.user,this.formGroup=this.formBuilder.group({name:[this.user.name,u.u.required],user_id:[this.user.user_id,u.u.required],password:["",u.u.required]})}},{key:"ngAfterViewInit",value:function(){}},{key:"close",value:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"closed";this.inputData.data.onClose(null,e)}},{key:"submitForm",value:function(){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formGroup.markAllAsTouched(),!this.formGroup.valid){e.next=5;break}return e.next=3,this.loadingCntrl.create({message:"Submitting..."});case 3:(t=e.sent).present(),this.baseAPI.executePatch({url:"".concat(b.c.user).concat(this.user.id,"/"),body:this.formGroup.value}).subscribe((function(e){t.dismiss(),n.close(e,"selected"),n.popoverService.showToast("The password has been updated successfully.",M.h,["success-toast"])}),(function(e){console.log(e),t.dismiss(),n.popoverService.showToast("The password could not be updated. Please try later.",M.h,["error-toast"])}));case 5:case"end":return e.stop()}}),e,this)})))}}]),e}()).\u0275fac=function(e){return new(e||s)(y["\u0275\u0275directiveInject"](E.a),y["\u0275\u0275directiveInject"](d.I),y["\u0275\u0275directiveInject"](u.d),y["\u0275\u0275directiveInject"](w.a),y["\u0275\u0275directiveInject"](g.a))},s.\u0275cmp=y["\u0275\u0275defineComponent"]({type:s,selectors:[["adj-password-change"]],decls:45,vars:3,consts:[[1,"ion-no-border","header-border"],[1,"ion-no-border"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],["slot","end"],["name","send-outline","slot","start"],[1,"ion-padding","white-bg"],[3,"formGroup","ngSubmit"],["appearance","outline"],["matInput","","type","text","formControlName","name",3,"readonly"],["matInput","","type","text","formControlName","user_id",3,"readonly"],["matInput","","type","password","formControlName","password"],[1,"ion-padding"],["type","submit","expand","block"]],template:function(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"ion-header",0),y["\u0275\u0275elementStart"](1,"ion-toolbar",1),y["\u0275\u0275elementStart"](2,"ion-buttons",2),y["\u0275\u0275elementStart"](3,"ion-button",3),y["\u0275\u0275listener"]("click",(function(){return t.close()})),y["\u0275\u0275element"](4,"ion-icon",4),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](5,"ion-title"),y["\u0275\u0275text"](6,"Change Password"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](7,"ion-buttons",5),y["\u0275\u0275elementStart"](8,"ion-button",3),y["\u0275\u0275listener"]("click",(function(){return t.submitForm()})),y["\u0275\u0275element"](9,"ion-icon",6),y["\u0275\u0275text"](10," Submit "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](11,"ion-content"),y["\u0275\u0275elementStart"](12,"div",7),y["\u0275\u0275elementStart"](13,"form",8),y["\u0275\u0275listener"]("ngSubmit",(function(){return t.submitForm()})),y["\u0275\u0275elementStart"](14,"ion-grid"),y["\u0275\u0275elementStart"](15,"ion-row"),y["\u0275\u0275elementStart"](16,"ion-col"),y["\u0275\u0275elementStart"](17,"mat-form-field",9),y["\u0275\u0275elementStart"](18,"mat-label"),y["\u0275\u0275text"](19,"User Name"),y["\u0275\u0275elementStart"](20,"sup"),y["\u0275\u0275text"](21,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](22,"input",10),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](23,"ion-row"),y["\u0275\u0275elementStart"](24,"ion-col"),y["\u0275\u0275elementStart"](25,"mat-form-field",9),y["\u0275\u0275elementStart"](26,"mat-label"),y["\u0275\u0275text"](27,"User ID"),y["\u0275\u0275elementStart"](28,"sup"),y["\u0275\u0275text"](29,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](30,"input",11),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](31,"ion-row"),y["\u0275\u0275elementStart"](32,"ion-col"),y["\u0275\u0275elementStart"](33,"mat-form-field",9),y["\u0275\u0275elementStart"](34,"mat-label"),y["\u0275\u0275text"](35,"Password"),y["\u0275\u0275elementStart"](36,"sup"),y["\u0275\u0275text"](37,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](38,"input",12),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](39,"ion-row"),y["\u0275\u0275elementStart"](40,"ion-col"),y["\u0275\u0275elementStart"](41,"div",13),y["\u0275\u0275elementStart"](42,"ion-button",14),y["\u0275\u0275element"](43,"ion-icon",6),y["\u0275\u0275text"](44,"Submit "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]()),2&e&&(y["\u0275\u0275advance"](13),y["\u0275\u0275property"]("formGroup",t.formGroup),y["\u0275\u0275advance"](9),y["\u0275\u0275property"]("readonly",!0),y["\u0275\u0275advance"](8),y["\u0275\u0275property"]("readonly",!0))},directives:[d.l,d.F,d.e,d.d,d.m,d.D,d.i,u.v,u.p,u.h,d.k,d.x,d.h,P.b,P.e,D.b,u.c,u.o,u.g],styles:["[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),s),T=a("lJxs"),N=a("N/Ph"),F=a("iadO"),U=a("bSwM");function V(e,t){if(1&e){var n=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"ion-buttons",8),y["\u0275\u0275elementStart"](1,"ion-button",3),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](n),y["\u0275\u0275nextContext"]().submitForm()})),y["\u0275\u0275element"](2,"ion-icon",9),y["\u0275\u0275text"](3," Submit "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]()}}function G(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"ion-col"),y["\u0275\u0275elementStart"](1,"mat-form-field",12),y["\u0275\u0275elementStart"](2,"mat-label"),y["\u0275\u0275text"](3,"Mobile Number"),y["\u0275\u0275elementStart"](4,"sup"),y["\u0275\u0275text"](5,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](6,"input",20),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]()),2&e){var n=y["\u0275\u0275nextContext"](2);y["\u0275\u0275advance"](6),y["\u0275\u0275property"]("readonly",n.mode==n.VIEW_MODE)}}function q(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"ion-col"),y["\u0275\u0275elementStart"](1,"mat-form-field",12),y["\u0275\u0275elementStart"](2,"mat-label"),y["\u0275\u0275text"](3,"Mobile Number"),y["\u0275\u0275elementStart"](4,"sup"),y["\u0275\u0275text"](5,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]())}function L(e,t){1&e&&(y["\u0275\u0275elementContainerStart"](0),y["\u0275\u0275elementStart"](1,"ion-row"),y["\u0275\u0275elementStart"](2,"ion-col"),y["\u0275\u0275elementStart"](3,"mat-form-field",12),y["\u0275\u0275elementStart"](4,"mat-label"),y["\u0275\u0275text"](5,"Role"),y["\u0275\u0275elementStart"](6,"sup"),y["\u0275\u0275text"](7,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](8,"input",21),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](9,"ion-row"),y["\u0275\u0275elementStart"](10,"ion-col"),y["\u0275\u0275elementStart"](11,"mat-form-field",12),y["\u0275\u0275elementStart"](12,"mat-label"),y["\u0275\u0275text"](13,"Location"),y["\u0275\u0275elementStart"](14,"sup"),y["\u0275\u0275text"](15,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](16,"input",22),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](17,"ion-col"),y["\u0275\u0275elementStart"](18,"mat-form-field",12),y["\u0275\u0275elementStart"](19,"mat-label"),y["\u0275\u0275text"](20,"Device ID"),y["\u0275\u0275elementStart"](21,"sup"),y["\u0275\u0275text"](22,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](23,"input",23),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](24,"ion-row"),y["\u0275\u0275elementStart"](25,"ion-col"),y["\u0275\u0275elementStart"](26,"mat-form-field",12),y["\u0275\u0275elementStart"](27,"mat-label"),y["\u0275\u0275text"](28,"Approved By"),y["\u0275\u0275elementStart"](29,"sup"),y["\u0275\u0275text"](30,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](31,"input",24),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementContainerEnd"]()),2&e&&(y["\u0275\u0275advance"](8),y["\u0275\u0275property"]("readonly",!0),y["\u0275\u0275advance"](8),y["\u0275\u0275property"]("readonly",!0),y["\u0275\u0275advance"](7),y["\u0275\u0275property"]("readonly",!0),y["\u0275\u0275advance"](8),y["\u0275\u0275property"]("readonly",!0))}var Q=function(e){return{"form-error":e}},B=function(){return[]};function z(e,t){if(1&e){var n=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementContainerStart"](0),y["\u0275\u0275elementStart"](1,"ion-row"),y["\u0275\u0275elementStart"](2,"ion-col"),y["\u0275\u0275elementStart"](3,"div",25),y["\u0275\u0275elementStart"](4,"div",26),y["\u0275\u0275text"](5,"Role"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](6,"adj-multi-select",27,28),y["\u0275\u0275listener"]("selected",(function(e){return y["\u0275\u0275restoreView"](n),y["\u0275\u0275nextContext"](2).handleRoleSelection(e)})),y["\u0275\u0275pipe"](8,"async"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](9,"ion-row"),y["\u0275\u0275elementStart"](10,"ion-col"),y["\u0275\u0275elementStart"](11,"div",25),y["\u0275\u0275elementStart"](12,"div",26),y["\u0275\u0275text"](13,"Location"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](14,"adj-multi-select",29,30),y["\u0275\u0275listener"]("selected",(function(e){return y["\u0275\u0275restoreView"](n),y["\u0275\u0275nextContext"](2).handleLocationSelection(e)})),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](16,"ion-row"),y["\u0275\u0275elementStart"](17,"ion-col"),y["\u0275\u0275elementStart"](18,"div",25),y["\u0275\u0275elementStart"](19,"div",26),y["\u0275\u0275text"](20,"Groups"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](21,"adj-multi-select",31,32),y["\u0275\u0275listener"]("selected",(function(e){return y["\u0275\u0275restoreView"](n),y["\u0275\u0275nextContext"](2).handleGroupSelection(e)})),y["\u0275\u0275pipe"](23,"async"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](24,"ion-row"),y["\u0275\u0275elementStart"](25,"ion-col"),y["\u0275\u0275elementStart"](26,"div",25),y["\u0275\u0275elementStart"](27,"div",26),y["\u0275\u0275text"](28,"Manager"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](29,"adj-multi-select",33,34),y["\u0275\u0275listener"]("selected",(function(e){return y["\u0275\u0275restoreView"](n),y["\u0275\u0275nextContext"](2).handleManagerSelection(e)})),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementContainerEnd"]()}if(2&e){var r,o,a=y["\u0275\u0275nextContext"](2),i=y["\u0275\u0275reference"](12),l=null==(r=y["\u0275\u0275pipeBind1"](8,12,a.roles$))?null:r.data,s=null==(o=y["\u0275\u0275pipeBind1"](23,14,a.groups$))?null:o.data;y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("ngClass",y["\u0275\u0275pureFunction1"](16,Q,(a.roleControl.dirty||a.roleControl.touched)&&a.roleControl.errors)),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("data",l)("multiple",!1),y["\u0275\u0275advance"](5),y["\u0275\u0275property"]("ngClass",y["\u0275\u0275pureFunction1"](18,Q,(a.locationControl.dirty||a.locationControl.touched)&&a.locationControl.errors)),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("data",y["\u0275\u0275pureFunction0"](20,B))("multiple",!1),y["\u0275\u0275advance"](4),y["\u0275\u0275property"]("ngClass",y["\u0275\u0275pureFunction1"](21,Q,(a.groupControl.dirty||a.groupControl.touched)&&a.groupControl.errors)),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("data",s),y["\u0275\u0275advance"](5),y["\u0275\u0275property"]("ngClass",y["\u0275\u0275pureFunction1"](23,Q,(a.managerControl.dirty||a.managerControl.touched)&&a.managerControl.errors)),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("viewTemplate",i)("url",a.apiDirectory.users)("multiple",!1)}}function H(e,t){if(1&e){var n=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementContainerStart"](0),y["\u0275\u0275elementStart"](1,"ion-row"),y["\u0275\u0275elementStart"](2,"ion-col"),y["\u0275\u0275elementStart"](3,"div",35),y["\u0275\u0275elementStart"](4,"ion-button",36),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](n),y["\u0275\u0275nextContext"](2).submitForm()})),y["\u0275\u0275element"](5,"ion-icon",9),y["\u0275\u0275text"](6,"Submit "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementContainerEnd"]()}}function W(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"div"),y["\u0275\u0275elementStart"](1,"div",10),y["\u0275\u0275elementStart"](2,"form",11),y["\u0275\u0275elementStart"](3,"ion-grid"),y["\u0275\u0275elementStart"](4,"ion-row"),y["\u0275\u0275elementStart"](5,"ion-col"),y["\u0275\u0275elementStart"](6,"mat-form-field",12),y["\u0275\u0275elementStart"](7,"mat-label"),y["\u0275\u0275text"](8,"User Id"),y["\u0275\u0275elementStart"](9,"sup"),y["\u0275\u0275text"](10,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](11,"input",13),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](12,"ion-col"),y["\u0275\u0275elementStart"](13,"mat-form-field",12),y["\u0275\u0275elementStart"](14,"mat-label"),y["\u0275\u0275text"](15,"Name"),y["\u0275\u0275elementStart"](16,"sup"),y["\u0275\u0275text"](17,"*"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](18,"input",14),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](19,"ion-row"),y["\u0275\u0275template"](20,G,7,1,"ion-col",6),y["\u0275\u0275template"](21,q,6,0,"ion-col",6),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](22,"ion-row"),y["\u0275\u0275elementStart"](23,"ion-col"),y["\u0275\u0275elementStart"](24,"mat-form-field",12),y["\u0275\u0275elementStart"](25,"mat-label"),y["\u0275\u0275text"](26,"Joining Date"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275element"](27,"input",15),y["\u0275\u0275element"](28,"mat-datepicker-toggle",16),y["\u0275\u0275element"](29,"mat-datepicker",null,17),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275template"](31,L,32,4,"ng-container",6),y["\u0275\u0275template"](32,z,31,25,"ng-container",6),y["\u0275\u0275elementStart"](33,"ion-row"),y["\u0275\u0275elementStart"](34,"ion-col"),y["\u0275\u0275elementStart"](35,"mat-checkbox",18),y["\u0275\u0275text"](36,"Active User "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](37,"p",19),y["\u0275\u0275text"](38,"Active user are allowed to use the mobile application and portal"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](39,"ion-row"),y["\u0275\u0275elementStart"](40,"ion-col"),y["\u0275\u0275elementStart"](41,"mat-checkbox",18),y["\u0275\u0275text"](42,"Staff User "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](43,"ion-row"),y["\u0275\u0275elementStart"](44,"ion-col"),y["\u0275\u0275elementStart"](45,"mat-checkbox",18),y["\u0275\u0275text"](46,"Approve User "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](47,"p",19),y["\u0275\u0275text"](48,"Approved user are allowed to use the mobile application and portal"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275template"](49,H,7,0,"ng-container",6),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]()),2&e){var n=y["\u0275\u0275reference"](30),r=y["\u0275\u0275nextContext"]();y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("formGroup",r.formGroup),y["\u0275\u0275advance"](9),y["\u0275\u0275property"]("readonly",!0),y["\u0275\u0275advance"](7),y["\u0275\u0275property"]("readonly",!0)("readonly",r.mode==r.VIEW_MODE),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngIf",r.mode==r.VIEW_MODE),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("ngIf",r.mode==r.EDIT_MODE),y["\u0275\u0275advance"](6),y["\u0275\u0275property"]("matDatepicker",n)("readonly",r.mode==r.VIEW_MODE),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("for",n),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("ngIf",r.mode==r.VIEW_MODE),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("ngIf",r.mode==r.EDIT_MODE),y["\u0275\u0275advance"](17),y["\u0275\u0275property"]("ngIf",r.mode==r.EDIT_MODE)}}function $(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"div"),y["\u0275\u0275elementStart"](1,"div"),y["\u0275\u0275text"](2),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](3,"div",37),y["\u0275\u0275text"](4),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]()),2&e){var n=t.option;y["\u0275\u0275advance"](2),y["\u0275\u0275textInterpolate"](n.name),y["\u0275\u0275advance"](2),y["\u0275\u0275textInterpolate3"]("",null==n.place?null:n.place.name," ","|"," ",null==n.role?null:n.role.name,"")}}var J,K=((J=function(t){n(a,t);var r=o(a);function a(){var e;return l(this,a),(e=r.apply(this,arguments)).mode=M.o,e.VIEW_MODE=M.o,e.EDIT_MODE=M.b,e}return c(a,[{key:"ngAfterViewInit",value:function(){var e=this;setTimeout((function(){e.mode=e.inputData.data.parameters.mode||M.o;var t=e.inputData.data.parameters.userId;t&&e.loadUserInfo(t)}),10)}},{key:"loadUserInfo",value:function(e){var t=this;this.baseAPI.get({url:""+b.c.user}).pipe(Object(T.a)((function(e){if(t.settings&&t.settings.country_code){var n=t.settings.country_code,r=Object(S.f)(n,e.mobile_number);return Object.assign(Object.assign({},e),{mobile_number:r})}return e}))).subscribe((function(e){t.user=e,t.formGroup=t.reIntialiseForm(),t.mode==M.b&&setTimeout((function(){t.initaliseMultiselect()}),10)}),(function(e){return t.body.error=e}))}},{key:"reIntialiseForm",value:function(){var e=this;return console.log("Reinitialise Form"+JSON.stringify(this.user.name)),this.formBuilder.group({user_id:[this.user.user_id,u.u.required],name:[this.user.name,u.u.required],role_id:[Object(S.s)(this.user.role,"id"),u.u.required],place_name:[this.user.place.name,u.u.required],mobile_number:[this.user.mobile_number,[u.u.required]],date_joined:[this.user.date_joined,[u.u.required]],device_id:[this.user.device_id,[u.u.required]],manager:[this.user.name,[u.u.required]],is_active:[{value:this.user.is_active,disabled:this.mode==M.o}],groups:this.formBuilder.array(Object(S.i)(this.user.groups)?[]:this.user.groups.map((function(t){return e.formBuilder.group(t)}))),role_name:[Object(S.s)(this.user.role,"name")],group_names:[Object(S.i)(this.user.groups)?"":this.user.groups.map((function(e){return e.name})).join()]})}},{key:"initaliseMultiselect",value:function(){console.log("LOC 504");var t=this.user.role,n=t?Object.assign(Object.assign({},t),{role_id:t.id,role_name:t.name}):null;this.roleMS?(this.roleMS.existingValues=n,this.handleRoleSelection(n)):console.log("roleMS not inisitalized"),this.locationMS?(this.locationMS.existingValues=this.user.place,this.locationControl.setValue(this.user.place.id)):console.log("locationMS not inisitalized"),this.groupMS?this.groupMS.existingValues=e(this.user.groups):console.log("groupsMS not inisitalized")}},{key:"submitForm",value:function(){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.formGroup.valid){e.next=6;break}return t=this.getData(),e.next=4,this.loadingCntrl.create({message:"Submitting..."});case 4:(n=e.sent).present(),this.baseAPI.executePatch({url:"".concat(b.c.user).concat(this.user.id,"/"),body:t}).subscribe((function(e){n.dismiss(),r.close(e,"selected"),r.popoverService.showToast("The user has been updated successfully.",1500,["success-toast"])}),(function(e){console.log(e),n.dismiss(),r.popoverService.showToast("The user could not be updated. Please try later.",1500,["error-toast"])}));case 6:case"end":return e.stop()}}),e,this)})))}}]),a}(j)).\u0275fac=function(e){return X(e||J)},J.\u0275cmp=y["\u0275\u0275defineComponent"]({type:J,selectors:[["adj-user-detail"]],viewQuery:function(e,t){var n;1&e&&y["\u0275\u0275viewQuery"](N.a,!0,N.a),2&e&&y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.body=n.first)},features:[y["\u0275\u0275InheritDefinitionFeature"]],decls:13,vars:3,consts:[[1,"ion-no-border","header-border"],[1,"ion-no-border"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],["slot","end",4,"ngIf"],[4,"ngIf"],["userTemplate",""],["slot","end"],["name","send-outline","slot","start"],[1,"ion-padding","white-bg"],[3,"formGroup"],["appearance","outline"],["matInput","","formControlName","user_id",3,"readonly"],["matInput","","formControlName","name",3,"readonly"],["matInput","","formControlName","date_joined",3,"matDatepicker","readonly"],["matSuffix","",3,"for"],["date_joined",""],["formControlName","is_active","color","primary"],[1,"small-font","mild"],["type","text","maxlength","10","matInput","","formControlName","mobile_number",3,"readonly"],["type","text","matInput","","formControlName","role_name",3,"readonly"],["type","text","matInput","","formControlName","place_name",3,"readonly"],["type","text","matInput","","formControlName","device_id",3,"readonly"],["type","text","matInput","","formControlName","manager",3,"readonly"],[1,"multi-select-form-field","ion-margin-vertical",3,"ngClass"],[1,"form-field-label"],["name","roles","mapFn","v=>v","type","local","idPropName","role_id","labelPropName","role_name",3,"data","multiple","selected"],["roles",""],["name","location","mapFn","v=>v","type","local","idPropName","id","labelPropName","name",3,"data","multiple","selected"],["locations",""],["name","groups","mapFn","v=>v","type","local","idPropName","id","labelPropName","name",3,"data","selected"],["groups",""],["name","managers","mapFn","response=>response.results","type","server","idPropName","id","labelPropName","name",3,"viewTemplate","url","multiple","selected"],["manager",""],[1,"ion-padding"],["type","submit","expand","block",3,"click"],[1,"small-font","mild",2,"padding-top","4px"]],template:function(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"ion-header",0),y["\u0275\u0275elementStart"](1,"ion-toolbar",1),y["\u0275\u0275elementStart"](2,"ion-buttons",2),y["\u0275\u0275elementStart"](3,"ion-button",3),y["\u0275\u0275listener"]("click",(function(){return t.close()})),y["\u0275\u0275element"](4,"ion-icon",4),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](5,"ion-title"),y["\u0275\u0275text"](6),y["\u0275\u0275elementEnd"](),y["\u0275\u0275template"](7,V,4,0,"ion-buttons",5),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](8,"ion-content"),y["\u0275\u0275elementStart"](9,"rainbow-body"),y["\u0275\u0275template"](10,W,50,12,"div",6),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275template"](11,$,5,4,"ng-template",null,7,y["\u0275\u0275templateRefExtractor"])),2&e&&(y["\u0275\u0275advance"](6),y["\u0275\u0275textInterpolate"](t.title),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("ngIf",t.mode&&t.mode==t.EDIT_MODE),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("ngIf",t.user))},directives:[d.l,d.F,d.e,d.d,d.m,d.D,m.NgIf,d.i,N.a,u.v,u.p,u.h,d.k,d.x,d.h,P.b,P.e,D.b,u.c,u.o,u.g,F.d,F.f,P.f,F.c,U.a,u.j,m.NgClass,h.a],pipes:[m.AsyncPipe],styles:["[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),J),X=y["\u0275\u0275getInheritedFactory"](K),Y=a("BD9Z"),Z=a("m8Yb"),ee=a("cjL1");function te(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"div",18),y["\u0275\u0275text"](1),y["\u0275\u0275elementEnd"]()),2&e){var n=y["\u0275\u0275nextContext"](2);y["\u0275\u0275advance"](1),y["\u0275\u0275textInterpolate2"](" ","Total Users"," - ",n.totalRecords," ")}}function ne(e,t){1&e&&(y["\u0275\u0275elementContainerStart"](0),y["\u0275\u0275text"](1,"Active"),y["\u0275\u0275elementContainerEnd"]())}function re(e,t){1&e&&(y["\u0275\u0275elementContainerStart"](0),y["\u0275\u0275text"](1,"Inactive"),y["\u0275\u0275elementContainerEnd"]())}function oe(e,t){if(1&e){var n=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"ion-row",25),y["\u0275\u0275listener"]("click",(function(e){y["\u0275\u0275restoreView"](n);var r=t.$implicit;return y["\u0275\u0275nextContext"](3).viewUser(e,r)})),y["\u0275\u0275elementStart"](1,"ion-col"),y["\u0275\u0275elementStart"](2,"div"),y["\u0275\u0275elementStart"](3,"div"),y["\u0275\u0275text"](4),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](5,"div",26),y["\u0275\u0275text"](6),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](7,"ion-col"),y["\u0275\u0275elementStart"](8,"div"),y["\u0275\u0275text"](9),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](10,"ion-col"),y["\u0275\u0275elementStart"](11,"div"),y["\u0275\u0275text"](12),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](13,"ion-col"),y["\u0275\u0275elementStart"](14,"div"),y["\u0275\u0275elementStart"](15,"ion-chip",27),y["\u0275\u0275template"](16,ne,2,0,"ng-container",28),y["\u0275\u0275template"](17,re,2,0,"ng-container",28),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](18,"ion-col",21),y["\u0275\u0275elementStart"](19,"div"),y["\u0275\u0275elementStart"](20,"ion-button",29),y["\u0275\u0275listener"]("click",(function(e){y["\u0275\u0275restoreView"](n);var r=t.$implicit;return y["\u0275\u0275nextContext"](3).showUserActions(e,r)})),y["\u0275\u0275element"](21,"ion-icon",23),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit;y["\u0275\u0275advance"](4),y["\u0275\u0275textInterpolate"](r.name),y["\u0275\u0275advance"](2),y["\u0275\u0275textInterpolate2"]("ID:",r.user_id," | ",null==r.role?null:r.role.name,""),y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"](r.mobile_number),y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"](null==r.place?null:r.place.name),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("color",r.is_active?"success":"danger"),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("ngIf",r.is_active),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("ngIf",!r.is_active)}}function ae(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"ion-grid",19),y["\u0275\u0275elementStart"](1,"ion-row",20),y["\u0275\u0275elementStart"](2,"ion-col"),y["\u0275\u0275elementStart"](3,"span"),y["\u0275\u0275text"](4),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](5,"ion-col"),y["\u0275\u0275elementStart"](6,"span"),y["\u0275\u0275text"](7),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](8,"ion-col"),y["\u0275\u0275elementStart"](9,"span"),y["\u0275\u0275text"](10),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](11,"ion-col"),y["\u0275\u0275elementStart"](12,"span"),y["\u0275\u0275text"](13),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](14,"ion-col",21),y["\u0275\u0275elementStart"](15,"span"),y["\u0275\u0275elementStart"](16,"ion-button",22),y["\u0275\u0275element"](17,"ion-icon",23),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275template"](18,oe,22,8,"ion-row",24),y["\u0275\u0275elementEnd"]()),2&e){var n=y["\u0275\u0275nextContext"]().results;y["\u0275\u0275advance"](4),y["\u0275\u0275textInterpolate"]("Name"),y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"]("Mobile"),y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"]("Location"),y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"]("Status"),y["\u0275\u0275advance"](5),y["\u0275\u0275property"]("ngForOf",n)}}function ie(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"div"),y["\u0275\u0275template"](1,te,2,2,"div",16),y["\u0275\u0275template"](2,ae,19,5,"ion-grid",17),y["\u0275\u0275elementEnd"]()),2&e){var n=t.results,r=y["\u0275\u0275nextContext"]();y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("ngIf",r.totalRecords),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("ngIf",n)}}var le,se,ce,me,ue=((le=function(){function e(t,n,r,o,a,i,s,c){l(this,e),this.popoverService=t,this.baseAPI=n,this.loadingCntrl=r,this.alertCntrl=o,this.orgService=a,this.popover=i,this.modalService=s,this.sortProvider=c,this.apiDirectory=b.c,this.changeEmployPermissions=[b.a],this.paginatedListConfig={url:b.c.users},this.sortOptions=this.intialiseSortOptions(),this.sortParam=new _.a("name","ASC",{label:"User Name",value:"name"}),this.status={value:!0,label:"Active",name:"status"},this.subscriptions=new Array,this.filter=new A,this.searchInput=new u.e}return c(e,[{key:"intialiseSortOptions",value:function(){var e=new Array;return e.push({label:"User Name",value:"name",meta:{}},{label:"Manager name",value:"manager__name",meta:{}},{label:"Role",value:"role__name",meta:{}},{label:"Location",value:"place__name",meta:{}}),e.sort((function(e,t){return e.label.localeCompare(t.label)})),e}},{key:"ngOnInit",value:function(){}},{key:"performSearch",value:function(){this.refresh()}},{key:"clear",value:function(){this.searchInput.reset(),this.refresh()}},{key:"mapUser",value:function(e){return e}},{key:"handleResponse",value:function(e){this.totalRecords=e.page.count}},{key:"refresh",value:function(){var e=new Map(this.filter.toQureryMap());e.set(S.d,this.sortParam.getQueryValue()),null!=this.status.value&&e.set(M.i,new Boolean(this.status.value).toString()),Object(S.l)(this.searchInput.value)&&(e.set(M.g,this.searchInput.value),e.set(M.f,"node")),this.paginatedList.setParams(e),this.paginatedList.refresh()}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout((function(){e.subscriptions.push(e.orgService.organisation.subscribe((function(t){e.refresh()})))}),10)}},{key:"sort",value:function(e){var t=this;this.sortProvider.open({params:{options:this.sortOptions,current:this.sortParam,header:"Sort By"},event:e,selectHandler:function(e){t.sortParam=e,t.refresh()}})}},{key:"showStatusOptions",value:function(e){var t=this;this.popover.showActions({event:e,params:{options:[{label:"All",value:null,name:"status",icon:"list-circle-outline"},{label:"Active",value:!0,name:"status",icon:"checkmark-circle-outline"},{label:"Inactive",value:!1,name:"status",icon:"close-outline"}],selectedValue:this.status},selectHandler:function(e){t.status={value:e.value,label:e.label,name:"status"},t.refresh()}})}},{key:"showUserActions",value:function(e,t){var n=this;e.stopPropagation();var r=[{label:"Change Password",value:"password",name:"password"},{label:"Edit",value:"edit",name:"edit",permissions:this.changeEmployPermissions},{label:"View",value:"view",name:"view"},{label:"Reset Device",value:"reset_device",name:"reset_device",permissions:[b.b]}];r.push(t.is_active?{label:"Mark Inactive",value:"inactive",name:"inactive"}:{label:"Mark Active",value:"active",name:"active"}),this.popover.showActions({event:e,params:{options:r},selectHandler:function(r){switch(r.value){case"edit":n.viewUser(e,t,M.b);break;case"view":n.viewUser(e,t,M.o);break;case"password":n.modalService.showModal({component:R,event:e,params:{user:t},selectHandler:function(e){n.refresh()}});break;case"inactive":n.changeUserStatusAlert(e,{header:"Inactive User",subheader:"Are you sure you want to mark ".concat(t.name," inactive?")},t,!1);break;case"active":n.changeUserStatusAlert(e,{header:"Activate User",subheader:"Are you sure you want to mark ".concat(t.name," active?")},t,!0);break;case"reset_device":n.handleResetDeviceAction(e,t)}}})}},{key:"viewUser",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M.o;this.modalService.showModal({component:K,event:e,params:{userId:t.id,mode:r},selectHandler:function(e){n.refresh()},cssClasses:[M.e]})}},{key:"showFilter",value:function(e){}},{key:"changeUserStatusAlert",value:function(e,t,n,r){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function o(){var a,i,l=this;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:a=Object(S.p)({key:"user",value:n},{key:"status",value:r}),i={cancel:function(){return!0},submit:function(e){var t=e.get("user"),n=e.get("status");return l.chageUserStatus(t,n),!0}},this.showOperationAlert(e,t,a,i);case 2:case"end":return o.stop()}}),o,this)})))}},{key:"showOperationAlert",value:function(e,t,n,r){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertCntrl.create({header:t.header,subHeader:t.subheader,buttons:[{text:"Cancel",handler:function(){r&&Object(S.k)(r.cancel)&&r.cancel()}},{text:"Submit",handler:function(){r&&Object(S.k)(r.submit)&&r.submit(n)}}]});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"chageUserStatus",value:function(e,t){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.loadingCntrl.create({message:M.j});case 2:(r=n.sent).present(),this.baseAPI.executePatch({url:"".concat(b.c.user).concat(e.id,"/"),body:{is_active:t}}).subscribe((function(e){r.dismiss(),o.popoverService.showToast(Object(M.n)("updated"),M.h,[M.k]),o.refresh()}),(function(e){console.log(e),r.dismiss(),o.popoverService.showToast(Object(M.m)("updated"),M.h,[M.c])}));case 4:case"end":return n.stop()}}),n,this)})))}},{key:"resetUserDevice",value:function(e){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadingCntrl.create({message:M.j});case 2:(n=t.sent).present(),this.baseAPI.executeDelete({url:"".concat(b.c.userDevice).concat(e.id,"/")}).subscribe((function(e){n.dismiss(),r.popoverService.showToast(Object(M.n)("updated"),M.h,[M.k]),r.refresh()}),(function(e){console.log(e),n.dismiss(),r.popoverService.showToast(Object(M.m)("updated"),M.h,[M.c])}));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"handleResetDeviceAction",value:function(e,t){var n=this,r=Map.from({key:"user",value:t}),o={cancel:function(){return!0},submit:function(e){return n.resetUserDevice(e.get("user")),!0}};this.showOperationAlert(e,{header:"Reset User Device",subheader:"Are you sure you want to reset ".concat(t.name,"'s device?")},r,o)}},{key:"ngOnDestroy",value:function(){Object(S.u)(this.subscriptions)}}]),e}()).\u0275fac=function(e){return new(e||le)(y["\u0275\u0275directiveInject"](w.a),y["\u0275\u0275directiveInject"](E.a),y["\u0275\u0275directiveInject"](d.I),y["\u0275\u0275directiveInject"](d.a),y["\u0275\u0275directiveInject"](Y.a),y["\u0275\u0275directiveInject"](w.a),y["\u0275\u0275directiveInject"](Z.a),y["\u0275\u0275directiveInject"](ee.a))},le.\u0275cmp=y["\u0275\u0275defineComponent"]({type:le,selectors:[["adj-user-list"]],viewQuery:function(e,t){var n;1&e&&y["\u0275\u0275viewQuery"](O.a,!0),2&e&&y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.paginatedList=n.first)},decls:31,vars:8,consts:[[1,"ion-padding-vertical"],[1,"ion-text-left","ion-margin-bottom"],[1,"ion-no-padding"],[1,"ion-align-items-center"],["size","6"],[1,"white-bg","search-bar"],["name","search-outline",1,"mild"],["type","text","placeholder","Search with user name, mobile or id...",3,"formControl","keydown.enter"],[1,"ion-padding-horizontal"],["size","small","fill","outline",3,"click"],[1,"ion-text-right"],["size","small",3,"fill","click"],["name","funnel-outline","slot","start"],["slot","end",3,"name"],[3,"config","lgTemplate","mapFn","onContent"],["usersTemplate",""],["class","ion-padding-bottom mild small-font",4,"ngIf"],["class","ion-no-padding adjoint-data-grid mat-elevation-z2 boder-box white-bg",4,"ngIf"],[1,"ion-padding-bottom","mild","small-font"],[1,"ion-no-padding","adjoint-data-grid","mat-elevation-z2","boder-box","white-bg"],[1,"grid-header","sticky-header"],["size","auto"],["fill","clear","color","dark",2,"opacity","0","max-height","1px"],["name","ellipsis-vertical-outline","slot","icon-only"],["class","white-bg ion-align-items-center",3,"click",4,"ngFor","ngForOf"],[1,"white-bg","ion-align-items-center",3,"click"],[1,"small-font","mild","small-margin-top"],[3,"color"],[4,"ngIf"],["fill","clear","color","dark",3,"click"]],template:function(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"div"),y["\u0275\u0275elementStart"](1,"ion-grid"),y["\u0275\u0275elementStart"](2,"ion-row",0),y["\u0275\u0275elementStart"](3,"ion-col"),y["\u0275\u0275elementStart"](4,"div",1),y["\u0275\u0275elementStart"](5,"div"),y["\u0275\u0275elementStart"](6,"ion-grid",2),y["\u0275\u0275elementStart"](7,"ion-row",3),y["\u0275\u0275elementStart"](8,"ion-col",4),y["\u0275\u0275elementStart"](9,"div",5),y["\u0275\u0275element"](10,"ion-icon",6),y["\u0275\u0275elementStart"](11,"input",7),y["\u0275\u0275listener"]("keydown.enter",(function(){return t.performSearch()})),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](12,"ion-col",8),y["\u0275\u0275elementStart"](13,"ion-button",9),y["\u0275\u0275listener"]("click",(function(){return t.performSearch()})),y["\u0275\u0275text"](14,"Search"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](15,"ion-button",9),y["\u0275\u0275listener"]("click",(function(){return t.clear()})),y["\u0275\u0275text"](16,"Clear"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](17,"ion-col"),y["\u0275\u0275elementStart"](18,"div",10),y["\u0275\u0275elementStart"](19,"ion-button",11),y["\u0275\u0275listener"]("click",(function(e){return t.showFilter(e)})),y["\u0275\u0275element"](20,"ion-icon",12),y["\u0275\u0275text"](21," Filter "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](22,"ion-button",9),y["\u0275\u0275listener"]("click",(function(e){return t.showStatusOptions(e)})),y["\u0275\u0275text"](23),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](24,"ion-button",9),y["\u0275\u0275listener"]("click",(function(e){return t.sort(e)})),y["\u0275\u0275text"](25),y["\u0275\u0275element"](26,"ion-icon",13),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](27,"rainbow-body"),y["\u0275\u0275elementStart"](28,"adjoint-paginated-list",14),y["\u0275\u0275listener"]("onContent",(function(e){return t.handleResponse(e)})),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275template"](29,ie,3,2,"ng-template",null,15,y["\u0275\u0275templateRefExtractor"])),2&e){var n=y["\u0275\u0275reference"](30);y["\u0275\u0275advance"](11),y["\u0275\u0275property"]("formControl",t.searchInput),y["\u0275\u0275advance"](8),y["\u0275\u0275property"]("fill",t.filter&&t.filter.isNotEmpty()?"solid":"outline"),y["\u0275\u0275advance"](4),y["\u0275\u0275textInterpolate1"](" ",t.status.label," "),y["\u0275\u0275advance"](2),y["\u0275\u0275textInterpolate1"](" ",t.sortParam.option.label," "),y["\u0275\u0275advance"](1),y["\u0275\u0275property"]("name","ASC"==t.sortParam.order?"arrow-down-outline":"arrow-up-outline"),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("config",t.paginatedListConfig)("lgTemplate",n)("mapFn",t.mapUser)}},directives:[d.k,d.x,d.h,d.m,u.c,u.o,u.f,d.d,N.a,O.a,m.NgIf,m.NgForOf,d.g],styles:[""]}),le),de=a("KiGM"),pe=a("eGxD"),fe=a("CId/"),ve=[{path:"",component:(se=function(){function e(t,n){l(this,e),this.modalService=t,this.orgService=n,this.config={title:"User Management",subtitle:"User access management for your application"}}return c(e,[{key:"ngOnInit",value:function(){this.orgService.myIndex=""}},{key:"addUser",value:function(e){var t=this;this.modalService.showModal({component:j,event:e,cssClasses:["right-aligned-full-height"],selectHandler:function(e){t.userList&&t.userList.refresh()}})}}]),e}(),se.\u0275fac=function(e){return new(e||se)(y["\u0275\u0275directiveInject"](Z.a),y["\u0275\u0275directiveInject"](Y.a))},se.\u0275cmp=y["\u0275\u0275defineComponent"]({type:se,selectors:[["adj-user-management"]],viewQuery:function(e,t){var n;1&e&&y["\u0275\u0275viewQuery"](ue,!0),2&e&&y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.userList=n.first)},decls:14,vars:1,consts:[[1,"ion-no-border","header-border"],[1,"ion-no-border"],["slot","end"],[3,"config"],["buttons",""],["fill","solid","shape","round",3,"click"],["slot","start","name","add"],[1,"ion-padding-horizontal"]],template:function(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"ion-header",0),y["\u0275\u0275elementStart"](1,"ion-toolbar",1),y["\u0275\u0275elementStart"](2,"ion-title"),y["\u0275\u0275element"](3,"adj-organisation"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](4,"ion-buttons",2),y["\u0275\u0275element"](5,"adj-user-profile"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](6,"ion-content"),y["\u0275\u0275elementStart"](7,"adj-page",3),y["\u0275\u0275elementStart"](8,"div",4),y["\u0275\u0275elementStart"](9,"ion-button",5),y["\u0275\u0275listener"]("click",(function(e){return t.addUser(e)})),y["\u0275\u0275element"](10,"ion-icon",6),y["\u0275\u0275text"](11," Add User "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementStart"](12,"div",7),y["\u0275\u0275element"](13,"adj-user-list"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"](),y["\u0275\u0275elementEnd"]()),2&e&&(y["\u0275\u0275advance"](7),y["\u0275\u0275property"]("config",t.config))},directives:[d.l,d.F,d.D,de.a,d.e,pe.a,d.i,fe.a,d.d,d.m,ue],styles:[""]}),se)}],he=((ce=function e(){l(this,e)}).\u0275mod=y["\u0275\u0275defineNgModule"]({type:ce}),ce.\u0275inj=y["\u0275\u0275defineInjector"]({factory:function(e){return new(e||ce)},imports:[[p.j.forChild(ve)],p.j]}),ce),ge=a("LkjY"),Se=a("NFeN"),be=a("1jcm"),ye=((me=function e(){l(this,e)}).\u0275mod=y["\u0275\u0275defineNgModule"]({type:me}),me.\u0275inj=y["\u0275\u0275defineInjector"]({factory:function(e){return new(e||me)},imports:[[m.CommonModule,u.i,d.G,he,ge.a,u.t,P.d,Se.a,D.c,be.a,U.b]]}),me)}}])}();